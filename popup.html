<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>S.P.A.R.E</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <!-- Header with Shield Icon -->
    <div class="header">
      <div class="header-content">
        <div class="shield-icon" id="shield-icon">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2L3 6V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V6L12 2Z" 
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M12 8V12M12 16H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="header-text">
          <h1>S.P.A.R.E</h1>
          <p class="header-subtitle">Security & Phishing Analysis</p>
        </div>
      </div>
    </div>

    <!-- Main Verdict Card -->
    <div class="verdict-card" id="verdict-card">
      <div class="threat-score-container">
        <div class="threat-score" id="threat-score">--</div>
        <div class="threat-label">THREAT SCORE</div>
      </div>
      
      <div class="verdict-content">
        <h2 class="verdict-headline" id="verdict-headline">Analyzing...</h2>
        <p class="verdict-recommendation" id="verdict-recommendation">Please wait while we scan this website.</p>
      </div>
    </div>

    <!-- Advanced Details Dropdown -->
    <details class="advanced-details" id="advanced-details">
      <summary>Advanced Analysis & Details</summary>
      
      <div class="details-content">
        <!-- URL Section -->
        <div class="detail-section">
          <div class="detail-label">Current URL</div>
          <div class="detail-value" id="current-url">--</div>
        </div>

        <!-- True Domain Section -->
        <div class="detail-section">
          <div class="detail-label">True Domain (DAVSS)</div>
          <div class="detail-value" id="true-domain">--</div>
        </div>

        <!-- Confidence Score -->
        <div class="detail-section">
          <div class="detail-label">ML Confidence Score</div>
          <div class="detail-value" id="ml-confidence">--</div>
        </div>

        <!-- TLD Status -->
        <div class="detail-section">
          <div class="detail-label">TLD Status</div>
          <div class="detail-value" id="tld-status">--</div>
        </div>

        <!-- Module Scores Breakdown -->
        <div class="detail-section">
          <div class="detail-label">Module Scores</div>
          <div class="module-breakdown">
            <div class="module-row">
              <span class="module-name">On-Page (ML)</span>
              <span class="module-score" id="module-onpage">--</span>
            </div>
            <div class="module-row">
              <span class="module-name">Visual (DAVSS)</span>
              <span class="module-score" id="module-visual">--</span>
            </div>
            <div class="module-row">
              <span class="module-name">Off-Page (Domain)</span>
              <span class="module-score" id="module-offpage">--</span>
            </div>
          </div>
        </div>

        <!-- Total Results -->
        <div class="detail-section">
          <div class="detail-label">Total Search Results</div>
          <div class="detail-value" id="total-results">--</div>
        </div>

        <!-- Suspicious Features -->
        <div class="detail-section">
          <div class="detail-label">Suspicious Indicators</div>
          <div class="detail-value" id="suspicious-features">--</div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
          <button class="action-btn" id="view-raw-btn">View Raw Data</button>
          <button class="action-btn" id="reanalyze-btn">Re-Analyze</button>
        </div>
      </div>
    </details>

    <!-- RL Feedback Section -->
    <div class="feedback-section" style="background: #18181b; border: 1px solid #27272a; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
      <div style="text-align: center; margin-bottom: 12px;">
        <h3 style="font-size: 13px; font-weight: 600; color: #a1a1aa; margin-bottom: 4px;">HELP IMPROVE DETECTION</h3>
        <p style="font-size: 11px; color: #71717a;">Was this prediction correct?</p>
      </div>
      <div style="display: flex; gap: 8px;">
        <button id="feedback-phishing" class="action-btn" style="flex: 1; background: #7f1d1d; border-color: #ef4444; color: #fecaca;">
          ! YES, PHISHING
        </button>
        <button id="feedback-safe" class="action-btn" style="flex: 1; background: #064e3b; border-color: #10b981; color: #a7f3d0;">
          âœ“ NO, SAFE
        </button>
      </div>
      <p id="feedback-status" style="margin-top: 8px; font-size: 10px; text-align: center; color: #71717a;"></p>
    </div>

    <!-- Raw Data Modal (Hidden by Default) -->
    <div class="modal" id="raw-modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Raw Technical Data</h3>
          <button class="close-modal" id="close-modal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="tabs">
            <button class="tab-btn active" data-tab="prediction">PREDICTION</button>
            <button class="tab-btn" data-tab="features">FEATURES</button>
            <button class="tab-btn" data-tab="offpage">OFF-PAGE</button>
            <button class="tab-btn" data-tab="visual">VISUAL</button>
            <button class="tab-btn" data-tab="raw">RAW</button>
          </div>
          
          <div class="tab-content">
            <div id="prediction-tab" class="tab-pane active">
              <pre id="prediction-output" class="code-block">...</pre>
            </div>
            <div id="features-tab" class="tab-pane">
              <pre id="features-output" class="code-block">...</pre>
            </div>
            <div id="offpage-tab" class="tab-pane">
              <pre id="offpage-output" class="code-block">...</pre>
            </div>
            <div id="visual-tab" class="tab-pane">
              <pre id="visual-output" class="code-block">...</pre>
            </div>
            <div id="raw-tab" class="tab-pane">
              <pre id="raw-output" class="code-block">...</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Load all as ES6 modules -->
  <script type="module" src="popup.js"></script>
</body>
</html>